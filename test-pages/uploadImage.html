<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>dnd binary upload</title>
    <script type="application/javascript">
        function sendFile(file) {
            const uri = "http://localhost:9001/avatar/upload";
            const xhr = new XMLHttpRequest();
            const fd = new FormData();

            xhr.open("PATCH", uri, true);
            xhr.onreadystatechange = () => {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    alert(xhr.responseText);
                }
            };
            fd.append('file', file);
            //fd.append('token', "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjNkNDY0OTcwMjlhOGMwYmFkN2I2MTU5IiwiZW5jcnlwdGVkUGFzc3dvcmQiOiIkMmEkMTAkanFUeXovOUIzQkguNlBZQUVPbnlPdTkwbHpyd0hBWURkNHFzMjJwWkpmWVNIakVkTnRrOFciLCJpYXQiOjE2NzQ4NjM3NjgsImV4cCI6MTY3NDg4NTM2OH0.TK8dfZqWgt3exm8PWCGaDMOcoXIdKe0mao3hyGl-FVE");
            xhr.setRequestHeader("x-access-token", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjNkNDY0OTcwMjlhOGMwYmFkN2I2MTU5IiwicGFzc3dvcmQiOiJyc2Nsb25lIiwiaWF0IjoxNjc0OTExNDMwLCJleHAiOjE2NzQ5MzMwMzB9.DfPJZwrqQTdwY_oD9qJUjEoScSc1MV2ySbG8ow7KGW4")
            xhr.send(fd);
        }

        window.onload = () => {
            const dropzone = document.getElementById("dropzone");
            dropzone.ondragover = dropzone.ondragenter = (event) => {
                event.stopPropagation();
                event.preventDefault();
            }

            dropzone.ondrop = (event) => {
                event.stopPropagation();
                event.preventDefault();

                const filesArray = event.dataTransfer.files;
                for (let i=0; i<filesArray.length; i++) {
                    sendFile(filesArray[i]);
                }
            }
        }
    </script>
</head>
<body>
    <div>
        <div id="dropzone" style="margin:30px; width:500px; height:300px; border:1px dotted grey;">Drag & drop your file here</div>
    </div>
</body>
</html>